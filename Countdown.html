<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Countdown</title>

<style>
body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #ffb6c1, #e4a0f7);
    color: white;
    text-align: center;
    padding-top: 60px;
    margin: 0;
}

.box {
    max-width: 420px;
    width: 90%;
    margin: auto;
    background: rgba(255, 255, 255, 0.15);
    padding: 35px;
    border-radius: 25px;
    backdrop-filter: blur(10px);
    box-shadow: 0px 0px 25px #ffffff55;
}

h2 {
    font-size: 30px;
    margin-bottom: 5px;
}

.subtxt {
    font-size: 15px;
    opacity: 0.9;
    margin-bottom: 25px;
}

.time {
    font-size: 24px;
    margin: 15px 0;
}

.progress {
    width: 100%;
    height: 22px;
    background: rgba(255,255,255,0.3);
    border-radius: 20px;
    overflow: hidden;
    margin-top: 20px;
}

.progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #ff6a88, #ff99cc, #e289ff);
    transition: 0.5s;
}

#percent {
    margin-top: 12px;
    font-size: 18px;
}

#messageSection {
    margin-top: 30px;
    text-align: left;
}

#msgInput {
    width: 100%;
    padding: 12px;
    border-radius: 15px;
    border: none;
    font-size: 16px;
}

#sendBtn {
    margin-top: 10px;
    width: 100%;
    background: #ff6a88;
    padding: 12px;
    border: none;
    border-radius: 15px;
    color: white;
    font-size: 16px;
    cursor: pointer;
}

#sendBtn:disabled {
    background: #ccc;
}

#messagesBox {
    margin-top: 20px;
    background: rgba(255,255,255,0.2);
    padding: 15px;
    border-radius: 20px;
    max-height: 300px;
    overflow-y: auto;
}

.msgItem {
    background: rgba(255,255,255,0.25);
    padding: 10px;
    border-radius: 12px;
    margin-bottom: 10px;
}

.timestamp {
    font-size: 12px;
    opacity: 0.8;
    margin-top: 5px;
}
</style>
</head>

<body>

<div class="box">
    <h2>üíó Love Countdown üíó</h2>
    <div class="subtxt">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Å‡∏≠‡∏î‡∏Å‡∏±‡∏ô: 09/01/2026 ‡πÄ‡∏ß‡∏•‡∏≤ 19:50</div>

    <div id="remain" class="time"></div>

    <div class="progress">
        <div id="bar" class="progress-bar"></div>
    </div>
    <div id="percent"></div>

    <div id="messageSection">
        <input id="msgInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏Ç‡∏≤..." />
        <button id="sendBtn">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° üíå</button>
        <div id="messagesBox">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...</div>
    </div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwvd3m2g4sJ9sfs44o0Uecsv49zMEudDDUmgiIClAF8DADdsyeKGIc2dbEet94Rljo/exec";

// ‚è≥ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß
const startDate = new Date("2025-12-23T08:30:00");
const endDate   = new Date("2026-01-09T19:50:00");

function updateCountdown() {
    const now = new Date();
    const passed = now - startDate;
    const total  = endDate - startDate;
    const remain = endDate - now;

    function format(ms) {
        if (ms < 0) ms = 0;
        let s = Math.floor(ms / 1000);
        let d = Math.floor(s / 86400);
        s %= 86400;
        let h = Math.floor(s / 3600);
        s %= 3600;
        let m = Math.floor(s / 60);
        s %= 60;
        return `${d} ‡∏ß‡∏±‡∏ô ${h} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ${m} ‡∏ô‡∏≤‡∏ó‡∏µ ${s} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;
    }

    document.getElementById("remain").innerHTML =
        "‡∏≠‡∏µ‡∏Å " + format(remain) + " ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô üíû";

    let p = Math.min(Math.max((passed / total) * 100, 0), 100).toFixed(2);
    document.getElementById("bar").style.width = p + "%";
    document.getElementById("percent").innerText = p + "% of the wait";
}

async function loadMessages() {
    const res = await fetch(API_URL);
    const msgs = await res.json();
    const box = document.getElementById("messagesBox");
    box.innerHTML = "";

    msgs.reverse().forEach(m => {
        box.innerHTML += `
            <div class="msgItem">
                ${m.message}
                <div class="timestamp">${m.timestamp || ""}</div>
            </div>`;
    });
}

async function sendMessage() {
    const input = document.getElementById("msgInput");
    const text = input.value.trim();
    if (!text) return;

    document.getElementById("sendBtn").disabled = true;

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ message: text }),
        headers: { "Content-Type": "application/json" },
        mode: "no-cors"
    });

    input.value = "";
    document.getElementById("sendBtn").disabled = false;
    loadMessages();
}

document.getElementById("sendBtn").onclick = sendMessage;
document.getElementById("msgInput").addEventListener("keypress", e => {
    if (e.key === "Enter") sendMessage();
});

setInterval(updateCountdown, 1000);
updateCountdown();
loadMessages();
setInterval(loadMessages, 5000);
</script>

</body>
</html>
